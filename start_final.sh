#!/bin/bash

# ===============================================
# ๐ ะะะะฃะกะ ะคะะะะะฌะะะ ะะะะกะะ
# ===============================================

echo "๐ ะะะะฃะกะ ะคะะะะะฌะะะ ะะะะกะะ"
echo "=================================="

# 1. ะััะฐะฝะฐะฒะปะธะฒะฐะตะผ ะฒัะต ะฟัะพัะตััั
echo "๐ ะััะฐะฝะฐะฒะปะธะฒะฐะตะผ ะฟัะพัะตััั..."
pkill -9 python || true
sleep 2

# 2. ะัะพะฒะตััะตะผ .env ัะฐะนะป
echo "๐ ะัะพะฒะตััะตะผ .env ัะฐะนะป..."
if [ ! -f ".env" ]; then
    echo "โ๏ธ ะกะพะทะดะฐะตะผ .env ัะฐะนะป..."
    echo "BOT_TOKEN=your_real_bot_token_here" > .env
    echo "๐ ะะะะะะะะ: ะะฐะผะตะฝะธัะต 'your_real_bot_token_here' ะฝะฐ ัะตะฐะปัะฝัะน ัะพะบะตะฝ!"
    echo "๐ค ะะพะปััะธัะต ัะพะบะตะฝ ั @BotFather ะฒ Telegram"
fi

# 3. ะะฐะฟััะบะฐะตะผ ัะธะฝะฐะปัะฝัะน ัะตัะฒะตั
echo "๐ ะะฐะฟััะบะฐะตะผ ัะธะฝะฐะปัะฝัะน ัะตัะฒะตั..."
python3 final_server.py &
SERVER_PID=$!
echo "โ ะกะตัะฒะตั ะทะฐะฟััะตะฝ ั PID: $SERVER_PID"

# 4. ะะดะตะผ ะทะฐะฟััะบะฐ ัะตัะฒะตัะฐ
echo "โณ ะะดะตะผ ะทะฐะฟััะบะฐ ัะตัะฒะตัะฐ..."
sleep 3

# 5. ะัะพะฒะตััะตะผ ัะตัะฒะตั
echo "๐ ะัะพะฒะตััะตะผ ัะตัะฒะตั..."
if curl -s http://localhost:8000 > /dev/null; then
    echo "โ ะกะตัะฒะตั ัะฐะฑะพัะฐะตั ะฝะฐ http://localhost:8000"
else
    echo "โ ะกะตัะฒะตั ะะ ะทะฐะฟััะตะฝ!"
    exit 1
fi

# 6. ะะฐะฟััะบะฐะตะผ ะฑะพัะฐ
echo "๐ค ะะฐะฟััะบะฐะตะผ ะฑะพัะฐ..."
python3 simple_bot.py &
BOT_PID=$!
echo "โ ะะพั ะทะฐะฟััะตะฝ ั PID: $BOT_PID"

echo ""
echo "๐ ะคะะะะะฌะะะฏ ะะะะกะะฏ ะะะะฃะฉะะะ!"
echo "=================================="
echo "๐ ะะฐะณะฐะทะธะฝ: http://localhost:8000"
echo "๐ ะะพัะทะธะฝะฐ: ะฒัััะพะตะฝะฐ ะฒ ะผะฐะณะฐะทะธะฝ"
echo "โ๏ธ ะะดะผะธะฝ: ะบะฝะพะฟะบะฐ 'โ๏ธ ะะดะผะธะฝ' ะฒ ะทะฐะณะพะปะพะฒะบะต"
echo "๐ค ะะพั: ะฝะฐัััะพะนัะต ัะพะบะตะฝ ะฒ .env"
echo ""
echo "โจ ะคะะะะะฌะะซะ ะคะฃะะะฆะะ:"
echo "   ๐ฆ ะะะกะขะะะฏ ะะะะะฏะะะ - ะะกะะะะ 2 ะกะขะะะะะะ"
echo "   ๐ฏ ะะะะะะฌะะะ ะะะะฃะะะขะะซะ ะขะะะะะซ"
echo "   โ๏ธ ะะะะะะขะะะะะะะะ ะะะฏะะ ะ ะะะะะะะะะะ"
echo "   ๐๏ธ ะะะะะฌะะะ ะฃะะะะะะะ ะะะะกะะะะ"
echo "   ๐ ะะะะะะฏ ะะะะะะะ ะะะะฃะะะ"
echo "   ๐จ ะะะะกะะะซะ ะะะขะะะคะะะก"
echo ""
echo "๐ PID ะฟัะพัะตััะพะฒ:"
echo "   ะกะตัะฒะตั: $SERVER_PID"
echo "   ะะพั: $BOT_PID"
echo ""
echo "๐ ะะปั ะพััะฐะฝะพะฒะบะธ:"
echo "   kill $SERVER_PID $BOT_PID"
echo "=================================="
