#!/bin/bash

# ===============================================
# ๐ ะะะะกะขะะ ะะะะฃะกะ ะะะะะะขะ
# ===============================================

echo "๐ ะะะะฃะกะ ะะะะกะขะะะ ะะะะะะขะ"
echo "=================================="

# 1. ะััะฐะฝะฐะฒะปะธะฒะฐะตะผ ะฒัะต ะฟัะพัะตััั
echo "๐ ะััะฐะฝะฐะฒะปะธะฒะฐะตะผ ะฟัะพัะตััั..."
pkill -9 python || true
sleep 2

# 2. ะัะพะฒะตััะตะผ .env ัะฐะนะป
echo "๐ ะัะพะฒะตััะตะผ .env ัะฐะนะป..."
if [ ! -f ".env" ]; then
    echo "โ๏ธ ะกะพะทะดะฐะตะผ .env ัะฐะนะป..."
    echo "BOT_TOKEN=your_real_bot_token_here" > .env
    echo "๐ ะะะะะะะะ: ะะฐะผะตะฝะธัะต 'your_real_bot_token_here' ะฝะฐ ัะตะฐะปัะฝัะน ัะพะบะตะฝ!"
    echo "๐ค ะะพะปััะธัะต ัะพะบะตะฝ ั @BotFather ะฒ Telegram"
fi

# 3. ะะฐะฟััะบะฐะตะผ ัะตัะฒะตั
echo "๐ ะะฐะฟััะบะฐะตะผ ะฒะตะฑ-ัะตัะฒะตั..."
python3 ultra_simple_server.py &
SERVER_PID=$!
echo "โ ะกะตัะฒะตั ะทะฐะฟััะตะฝ ั PID: $SERVER_PID"

# 4. ะะดะตะผ ะทะฐะฟััะบะฐ ัะตัะฒะตัะฐ
echo "โณ ะะดะตะผ ะทะฐะฟััะบะฐ ัะตัะฒะตัะฐ..."
sleep 3

# 5. ะัะพะฒะตััะตะผ ัะตัะฒะตั
echo "๐ ะัะพะฒะตััะตะผ ัะตัะฒะตั..."
if curl -s http://localhost:8000 > /dev/null; then
    echo "โ ะกะตัะฒะตั ัะฐะฑะพัะฐะตั ะฝะฐ http://localhost:8000"
else
    echo "โ ะกะตัะฒะตั ะะ ะทะฐะฟััะตะฝ!"
    exit 1
fi

# 6. ะะฐะฟััะบะฐะตะผ ะฑะพัะฐ
echo "๐ค ะะฐะฟััะบะฐะตะผ ะฑะพัะฐ..."
python3 simple_bot.py &
BOT_PID=$!
echo "โ ะะพั ะทะฐะฟััะตะฝ ั PID: $BOT_PID"

echo ""
echo "๐ ะะกะ ะะะะฃะฉะะะ!"
echo "=================================="
echo "๐ ะะฐะณะฐะทะธะฝ: http://localhost:8000"
echo "โ๏ธ ะะดะผะธะฝ: http://localhost:8000/admin"
echo "๐ค ะะพั: ะฝะฐัััะพะนัะต ัะพะบะตะฝ ะฒ .env"
echo ""
echo "๐ PID ะฟัะพัะตััะพะฒ:"
echo "   ะกะตัะฒะตั: $SERVER_PID"
echo "   ะะพั: $BOT_PID"
echo ""
echo "๐ ะะปั ะพััะฐะฝะพะฒะบะธ:"
echo "   kill $SERVER_PID $BOT_PID"
echo "=================================="
