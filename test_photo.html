<!DOCTYPE html>
<html>
<head>
    <title>–¢–µ—Å—Ç —Ñ–æ—Ç–æ</title>
</head>
<body>
    <h1>–¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ</h1>
    <input type="file" id="photoInput" accept="image/*">
    <button onclick="testPhoto()">–¢–µ—Å—Ç —Ñ–æ—Ç–æ</button>
    <div id="result"></div>

    <script>
        let selectedPhoto = null;

        document.getElementById('photoInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    selectedPhoto = e.target.result;
                    document.getElementById('result').innerHTML = 
                        `<p>–§–æ—Ç–æ –≤—ã–±—Ä–∞–Ω–æ: ${file.name} (${Math.round(file.size/1024)} KB)</p>`;
                };
                reader.readAsDataURL(file);
            }
        });

        async function testPhoto() {
            if (!selectedPhoto) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ç–æ!');
                return;
            }

            try {
                const data = {
                    title: "–¢–µ—Å—Ç —Ñ–æ—Ç–æ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞",
                    price: 555,
                    description: "",
                    image: "üì∑",
                    photo: selectedPhoto
                };
                
                console.log('–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ:', {
                    title: data.title,
                    price: data.price,
                    photoLength: data.photo.length
                });
                
                const response = await fetch('/api/products', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Admin-Password': 'admin123'
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                document.getElementById('result').innerHTML += 
                    `<p>–†–µ–∑—É–ª—å—Ç–∞—Ç: ${JSON.stringify(result)}</p>`;
                
            } catch (error) {
                document.getElementById('result').innerHTML += 
                    `<p>–û—à–∏–±–∫–∞: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
