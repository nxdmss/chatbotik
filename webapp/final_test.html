<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        button { padding: 10px 20px; margin: 10px; cursor: pointer; }
        #log { border: 1px solid #ccc; padding: 10px; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞</h1>
    
    <button onclick="testAdd()">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
    <button onclick="testDelete()">–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä ID=1</button>
    <button onclick="loadProducts()">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–≤–∞—Ä—ã</button>
    
    <div id="log"></div>
    
    <script>
        const API_BASE = window.location.origin;
        const log = document.getElementById('log');
        
        function addLog(msg) {
            log.innerHTML += '<br>' + msg;
            console.log(msg);
        }
        
        async function testAdd() {
            try {
                addLog('üöÄ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ...');
                
                const productData = {
                    title: "–¢–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä",
                    description: "–û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞",
                    price: 1500,
                    sizes: ["M", "L", "XL"]
                };
                
                addLog('üì¶ –î–∞–Ω–Ω—ã–µ: ' + JSON.stringify(productData));
                
                const response = await fetch(`${API_BASE}/webapp/admin/products?user_id=admin`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(productData)
                });
                
                addLog('üì° –û—Ç–≤–µ—Ç: ' + response.status);
                
                const result = await response.json();
                addLog('‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: ' + JSON.stringify(result));
                
                if (result.success) {
                    alert('‚úÖ –¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω! ID: ' + result.product_id);
                }
            } catch (error) {
                addLog('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
                alert('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
            }
        }
        
        async function testDelete() {
            try {
                addLog('üóëÔ∏è –£–¥–∞–ª—è–µ–º —Ç–æ–≤–∞—Ä...');
                
                const response = await fetch(`${API_BASE}/webapp/admin/products/1?user_id=admin`, {
                    method: 'DELETE'
                });
                
                const result = await response.json();
                addLog('‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: ' + JSON.stringify(result));
                alert('‚úÖ –¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω!');
            } catch (error) {
                addLog('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
            }
        }
        
        async function loadProducts() {
            try {
                addLog('üì¶ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–≤–∞—Ä—ã...');
                
                const response = await fetch(`${API_BASE}/webapp/products.json`);
                const products = await response.json();
                
                addLog('‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: ' + products.length);
                products.forEach(p => {
                    addLog(`  - ${p.id}. ${p.title} - ${p.price} —Ä—É–±`);
                });
            } catch (error) {
                addLog('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
            }
        }
        
        addLog('‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è —Ç–µ—Å—Ç–∞!');
    </script>
</body>
</html>

