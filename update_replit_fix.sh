#!/bin/bash
# Быстрое обновление для исправления админ панели в Replit

echo "🔧 БЫСТРОЕ ИСПРАВЛЕНИЕ АДМИН ПАНЕЛИ В REPLIT"
echo "============================================="

# 1. Обновляем проект
echo "📥 Обновляем проект из GitHub..."
git pull origin main

# 2. Останавливаем процессы
echo "🛑 Останавливаем старые процессы..."
pkill -9 python 2>/dev/null
pkill -9 python3 2>/dev/null
sleep 2

# 3. Запускаем сервер
echo "🚀 Запускаем сервер..."
python3 perfect_server.py &

# 4. Ждем запуска
sleep 3

# 5. Проверяем работу
echo "✅ Проверяем работу сервера..."
if curl -s http://localhost:8000 > /dev/null; then
    echo "✅ Сервер работает!"
    echo ""
    echo "🎯 ГОТОВО!"
    echo "🌐 Откройте приложение в браузере"
    echo "🔧 Админ панель должна появиться автоматически"
    echo "🔴 Если нет - нажмите красную кнопку в правом верхнем углу"
    echo ""
    echo "📋 Проверьте консоль браузера (F12) - должны быть логи:"
    echo "   🔧 Отладочный режим: Replit/localhost обнаружен"
    echo "   👑 Админские права предоставлены в отладочном режиме"
else
    echo "❌ Ошибка запуска сервера"
fi
