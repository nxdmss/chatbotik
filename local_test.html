<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–æ–∫–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –º–∞–≥–∞–∑–∏–Ω–∞</title>
    <link rel="stylesheet" href="webapp/styles.css">
    <style>
        .test-panel {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 15px;
            border-radius: 8px;
            z-index: 10000;
            font-size: 12px;
            max-width: 300px;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 12px;
            margin: 3px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .test-button.success {
            background: #28a745;
        }
        .test-button.danger {
            background: #dc3545;
        }
        .test-button.warning {
            background: #ffc107;
            color: #000;
        }
        .status {
            margin-top: 10px;
            padding: 5px;
            border-radius: 4px;
            font-size: 10px;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
        }
    </style>
</head>
<body>
    <div class="test-panel">
        <h4>üß™ –õ–æ–∫–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –º–∞–≥–∞–∑–∏–Ω–∞</h4>
        <div>
            <button class="test-button" onclick="testConnection()">üîó –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</button>
            <button class="test-button" onclick="testAddProduct()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
            <button class="test-button" onclick="testEditProduct()">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            <button class="test-button danger" onclick="testDeleteProduct()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
        </div>
        <div>
            <button class="test-button warning" onclick="testSearch()">üîç –ü–æ–∏—Å–∫</button>
            <button class="test-button" onclick="testCart()">üõí –ö–æ—Ä–∑–∏–Ω–∞</button>
            <button class="test-button" onclick="testNotifications()">üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</button>
            <button class="test-button" onclick="clearLog()">üßπ –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
        </div>
        <div id="status" class="status info" style="display: none;">
            –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
        </div>
        <div id="log" style="max-height: 200px; overflow-y: auto; margin-top: 10px; font-size: 10px; background: rgba(255,255,255,0.1); padding: 5px; border-radius: 4px;">
            <div>üìù –õ–æ–≥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</div>
        </div>
    </div>

    <div class="app">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <header class="header">
            <h1>üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω (–õ–æ–∫–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç)</h1>
            <div class="cart-badge" id="cart-badge" style="display: none;">0</div>
        </header>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="main">
            <!-- –ö–∞—Ç–∞–ª–æ–≥ -->
            <div class="page" id="catalog-page">
                <div class="search-container">
                    <input type="text" id="search" placeholder="üîç –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤..." class="search-input">
                </div>
                
                <div class="products-grid" id="products-grid">
                    <!-- –¢–æ–≤–∞—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ -->
                <div class="admin-actions" id="admin-actions" style="display: block;">
                    <button class="btn btn-primary btn-lg btn-full" onclick="showAddProductModal()">
                        ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
                    </button>
                </div>
            </div>

            <!-- –ö–æ—Ä–∑–∏–Ω–∞ -->
            <div class="page" id="cart-page" style="display: none;">
                <div class="cart-header">
                    <h2>üõí –ö–æ—Ä–∑–∏–Ω–∞</h2>
                    <button class="btn btn-outline btn-sm" onclick="clearCart()">–û—á–∏—Å—Ç–∏—Ç—å</button>
                </div>
                
                <div class="cart-items" id="cart-items">
                    <!-- –¢–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω–µ -->
                </div>
                
                <div class="cart-footer">
                    <div class="cart-total">
                        <span>–ò—Ç–æ–≥–æ: <span id="cart-total">0 ‚ÇΩ</span></span>
                    </div>
                    <button class="btn btn-primary btn-lg btn-full" onclick="checkout()">
                        üí≥ –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
                    </button>
                </div>
            </div>

            <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
            <div class="page" id="profile-page" style="display: none;">
                <div class="profile-header">
                    <h2>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h2>
                </div>
                
                <div class="profile-content">
                    <div class="profile-info">
                        <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à –º–∞–≥–∞–∑–∏–Ω!</p>
                        <p>–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤–æ–∏–º–∏ –∑–∞–∫–∞–∑–∞–º–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏.</p>
                    </div>
                    
                    <div class="profile-actions">
                        <button class="btn btn-outline btn-full" onclick="showModal('orders-modal')">
                            üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã
                        </button>
                        <button class="btn btn-outline btn-full" onclick="showModal('faq-modal')">
                            ‚ùì FAQ
                        </button>
                        <button class="btn btn-outline btn-full" onclick="contactAdmin()">
                            üìû –°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏
                        </button>
                    </div>
                </div>
            </div>

            <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
            <div class="page" id="admin-page" style="display: none;">
                <div class="admin-header">
                    <h2>‚öôÔ∏è –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
                </div>
                
                <div class="admin-content">
                    <div class="admin-stats" id="admin-stats">
                        <div class="stat-card">
                            <h3>–¢–æ–≤–∞—Ä—ã</h3>
                            <span id="products-count">0</span>
                        </div>
                        <div class="stat-card">
                            <h3>–ó–∞–∫–∞–∑—ã</h3>
                            <span id="orders-count">0</span>
                        </div>
                    </div>
                    
                    <div class="admin-products">
                        <div class="admin-products-header">
                            <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h3>
                            <button class="btn btn-primary btn-sm" onclick="showAddProductModal()">
                                ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
                            </button>
                        </div>
                        
                        <div class="products-list" id="admin-products-list">
                            <!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –∞–¥–º–∏–Ω–∞ -->
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="nav">
            <button class="nav-item active" data-page="catalog">
                <span class="nav-icon">üõçÔ∏è</span>
                <span class="nav-label">–ö–∞—Ç–∞–ª–æ–≥</span>
            </button>
            <button class="nav-item" data-page="cart">
                <span class="nav-icon">üõí</span>
                <span class="nav-label">–ö–æ—Ä–∑–∏–Ω–∞</span>
            </button>
            <button class="nav-item" data-page="profile">
                <span class="nav-icon">üë§</span>
                <span class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</span>
            </button>
            <button class="nav-item" data-page="admin" id="admin-nav-btn" style="display: block;">
                <span class="nav-icon">‚öôÔ∏è</span>
                <span class="nav-label">–ê–¥–º–∏–Ω</span>
            </button>
        </nav>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–∫–∞–∑–æ–≤ -->
    <div class="modal" id="orders-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã</h3>
                <button class="modal-close" onclick="hideModal('orders-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <p>–ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤–∞—à–∏ –∑–∞–∫–∞–∑—ã.</p>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ FAQ -->
    <div class="modal" id="faq-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ùì –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h3>
                <button class="modal-close" onclick="hideModal('faq-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="faq-item">
                    <h4>–ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑?</h4>
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ, –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ –∫–æ—Ä–∑–∏–Ω—É –∏ –æ—Ñ–æ—Ä–º–∏—Ç–µ –∑–∞–∫–∞–∑.</p>
                </div>
                <div class="faq-item">
                    <h4>–ö–∞–∫ –æ–ø–ª–∞—Ç–∏—Ç—å –∑–∞–∫–∞–∑?</h4>
                    <p>–û–ø–ª–∞—Ç–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ Telegram Payments.</p>
                </div>
                <div class="faq-item">
                    <h4>–°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ—Å—Ç–∞–≤–∫–∞?</h4>
                    <p>–û–±—ã—á–Ω–æ 1-3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ -->
    <div class="modal" id="product-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="product-modal-title">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h3>
                <button class="modal-close" onclick="hideModal('product-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="product-form" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="product-title">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</label>
                        <input type="text" id="product-title" name="title" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="product-description">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="product-description" name="description" rows="3" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="product-price">–¶–µ–Ω–∞ (‚ÇΩ)</label>
                        <input type="number" id="product-price" name="price" min="0" step="0.01" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="product-sizes">–†–∞–∑–º–µ—Ä—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                        <input type="text" id="product-sizes" name="sizes" placeholder="40, 41, 42, 43">
                    </div>
                    
                    <div class="form-group">
                        <label for="product-photo">–§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞</label>
                        <input type="file" id="product-photo" name="photo" accept="image/*">
                        <div class="photo-preview" id="photo-preview" style="display: none;">
                            <img id="preview-img" src="" alt="–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä">
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline" onclick="hideModal('product-modal')">
                            –û—Ç–º–µ–Ω–∞
                        </button>
                        <button type="submit" class="btn btn-primary">
                            –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="webapp/app.js"></script>
    
    <script>
        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#ff6b6b' : type === 'success' ? '#51cf66' : '#74c0fc';
            logDiv.innerHTML += `<div style="color: ${color};">[${timestamp}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            statusDiv.style.display = 'block';
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 3000);
        }
        
        function clearLog() {
            document.getElementById('log').innerHTML = '<div>üìù –õ–æ–≥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</div>';
        }
        
        // –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        async function testConnection() {
            log('üîó –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É...');
            try {
                const response = await fetch('/webapp/products.json');
                if (response.ok) {
                    const data = await response.json();
                    log(`‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ! –ü–æ–ª—É—á–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: ${data.length}`, 'success');
                    showStatus('–°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç!', 'success');
                } else {
                    log(`‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ${response.status}`, 'error');
                    showStatus('–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞!', 'error');
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${error.message}`, 'error');
                showStatus('–°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω!', 'error');
            }
        }
        
        function testAddProduct() {
            log('‚ûï –¢–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞');
            if (window.mobileShopApp) {
                window.mobileShopApp.showAddProductModal();
                showStatus('–§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ—Ç–∫—Ä—ã—Ç–∞', 'info');
            } else {
                log('‚ùå –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ', 'error');
                showStatus('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏!', 'error');
            }
        }
        
        function testEditProduct() {
            log('‚úèÔ∏è –¢–µ—Å—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞');
            if (window.mobileShopApp && window.mobileShopApp.products.length > 0) {
                window.mobileShopApp.editProduct(window.mobileShopApp.products[0].id);
                showStatus('–§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–∫—Ä—ã—Ç–∞', 'info');
            } else {
                log('‚ùå –ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
                showStatus('–ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤!', 'error');
            }
        }
        
        function testDeleteProduct() {
            log('üóëÔ∏è –¢–µ—Å—Ç —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞');
            if (window.mobileShopApp && window.mobileShopApp.products.length > 0) {
                if (confirm('–£–¥–∞–ª–∏—Ç—å –ø–µ—Ä–≤—ã–π —Ç–æ–≤–∞—Ä?')) {
                    window.mobileShopApp.deleteProduct(window.mobileShopApp.products[0].id);
                    showStatus('–£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ', 'info');
                }
            } else {
                log('‚ùå –ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è', 'error');
                showStatus('–ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤!', 'error');
            }
        }
        
        function testSearch() {
            log('üîç –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞');
            const searchInput = document.getElementById('search');
            if (searchInput) {
                searchInput.value = '–∫—Ä–æ—Å—Å–æ–≤–∫–∏';
                searchInput.dispatchEvent(new Event('input'));
                showStatus('–ü–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω', 'info');
            }
        }
        
        function testCart() {
            log('üõí –¢–µ—Å—Ç –∫–æ—Ä–∑–∏–Ω—ã');
            if (window.mobileShopApp) {
                window.mobileShopApp.showPage('cart');
                showStatus('–ö–æ—Ä–∑–∏–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∞', 'info');
            }
        }
        
        function testNotifications() {
            log('üîî –¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π');
            if (window.mobileShopApp) {
                window.mobileShopApp.showNotification('–¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ!', 'success');
                setTimeout(() => {
                    window.mobileShopApp.showNotification('–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!', 'error');
                }, 1000);
                setTimeout(() => {
                    window.mobileShopApp.showNotification('–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ', 'info');
                }, 2000);
                showStatus('–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã', 'info');
            }
        }
        
        // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º console.log –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ª–æ–≥–µ
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            const message = args.join(' ');
            if (message.includes('‚úÖ') || message.includes('‚ùå') || message.includes('üì¶') || message.includes('üíæ')) {
                log(message);
            }
        };
        
        // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º console.error
        const originalError = console.error;
        console.error = function(...args) {
            originalError.apply(console, args);
            const message = args.join(' ');
            log(message, 'error');
        };
    </script>
</body>
</html>
