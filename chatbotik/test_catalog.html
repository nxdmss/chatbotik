<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∫–∞—Ç–∞–ª–æ–≥–∞</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .product-card { border: 1px solid #ccc; padding: 10px; margin: 10px 0; }
        .loading { color: #666; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>
    <h1>–¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–∞–ª–æ–≥–∞</h1>
    <div id="status"></div>
    <div id="productsContainer" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...</div>

    <script>
        let products = [];
        
        async function loadProducts() {
            console.log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É —Ç–æ–≤–∞—Ä–æ–≤...');
            console.log('üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ productsContainer:', document.getElementById('productsContainer'));
            
            try {
                console.log('üì° –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ /api/products');
                const response = await fetch('/api/products');
                console.log('üì° –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç:', response.status, response.statusText);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const responseText = await response.text();
                console.log('üìÑ –ü–æ–ª—É—á–µ–Ω —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞:', responseText.substring(0, 200) + '...');
                
                products = JSON.parse(responseText);
                console.log('üì¶ –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤:', products.length);
                console.log('üì¶ –ü–µ—Ä–≤—ã–µ —Ç–æ–≤–∞—Ä—ã:', products.slice(0, 3));
                
                console.log('üé® –í—ã–∑—ã–≤–∞–µ–º renderProducts()');
                renderProducts();
                
                console.log('‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');
                document.getElementById('status').innerHTML = '<div class="success">‚úÖ –¢–æ–≤–∞—Ä—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!</div>';
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤:', error);
                console.error('‚ùå Stack trace:', error.stack);
                document.getElementById('status').innerHTML = '<div class="error">‚ùå –û—à–∏–±–∫–∞: ' + error.message + '</div>';
                const container = document.getElementById('productsContainer');
                if (container) {
                    container.innerHTML = '<div class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤: ' + error.message + '</div>';
                }
            }
        }
        
        function renderProducts() {
            console.log('üé® renderProducts() –≤—ã–∑–≤–∞–Ω–∞');
            console.log('üì¶ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:', products.length);
            
            const container = document.getElementById('productsContainer');
            console.log('üéØ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞–π–¥–µ–Ω:', container);
            
            if (!container) {
                console.error('‚ùå –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä productsContainer –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                return;
            }
            
            if (products.length === 0) {
                container.innerHTML = '<div class="loading">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }
            
            console.log('üõçÔ∏è –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤:', products.length);
            products.forEach(product => {
                console.log(`üì¶ –¢–æ–≤–∞—Ä: ${product.title}, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: ${product.image_url || '–Ω–µ—Ç'}`);
            });
            
            container.innerHTML = products.map(product => `
                <div class="product-card">
                    <h3>${product.title}</h3>
                    <p>–¶–µ–Ω–∞: ${product.price} ‚ÇΩ</p>
                    <p>–û–ø–∏—Å–∞–Ω–∏–µ: ${product.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
                    <p>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: ${product.image_url || '–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è'}</p>
                    <p>–†–∞–∑–º–µ—Ä—ã: ${product.sizes || '–ù–µ—Ç —Ä–∞–∑–º–µ—Ä–æ–≤'}</p>
                </div>
            `).join('');
            
            console.log('‚úÖ HTML —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏ –≤—Å—Ç–∞–≤–ª–µ–Ω –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä');
            console.log('üé® –î–ª–∏–Ω–∞ HTML:', container.innerHTML.length);
            console.log('‚úÖ renderProducts() –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');
        }
        
        // –ó–∞–ø—É—Å–∫
        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
        });
    </script>
</body>
</html>
